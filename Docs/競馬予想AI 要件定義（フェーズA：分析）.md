# 競馬予想AI 要件定義（フェーズA：分析）

## 位置づけ

* 本ドキュメントは**要件定義**であり、設計・実装・取得方法は含めない。
* フェーズAは分析専用。買い目生成（フェーズB）は要件外。

---

## 目的（フェーズA）

**過去10年のデータから、特定レースにおける有意な傾向を抽出し、
その傾向が現在の出馬表の各馬にどの程度当てはまるかを、
数値と根拠をもって正しく提示すること。**

---

## 対象範囲

* レース：フェブラリーS（単一レース特化）
* 期間：過去10年
* 対象馬：全頭
* 評価基準：3着内
* 参照履歴：直近5走

---

## 評価指標

* 主指標：的中率（3着内）
* 次点指標：回収率（参考）
* 期待値：フェーズAでは扱わない

---

## 分析要件

* 単条件および複合条件（AND条件）で傾向を算出できること
* 傾向は**年別3着内率の中央値**を代表値として用いること
* 母数が極端に小さい条件は、その旨を明示すること

---

## 出力要件（フェーズA）

フェーズAの出力は以下を必須とする。

### 各馬ごとの出力

* 評価スコア（3着内に入る確率を示す指標）
* 順位（相対評価）
* 根拠一覧

### 根拠の表現規約

* 根拠は**競馬のデータ分析記事と同等の具体性**を持つこと
* 各根拠には以下を含めること

  * 条件内容（例：脚質が先行 かつ 前走G1）
  * 母数（例：過去10年の3着内馬30頭中◯頭）
  * 割合（％）
* 寄与度を曖昧語（強・中・弱）で表現しない

### 不確実性の扱い

* 特別な指標は必須としない
* 母数や分布の偏りは説明文で明示する

---

## 完成判定（Done条件）

フェーズAは、以下をすべて満たした場合に完了とする。

1. 過去10年の全データから、単条件・複合条件の傾向（3着内率）を算出できる
2. 各傾向について、条件内容・母数・割合を**虚偽なく**出力できる
3. 現在の出馬表に対し、傾向に合致する馬を抽出・説明できる
4. 各馬の3着内勝率を、数値と根拠付きで提示できる
5. 出力内容がデータと整合しており、嘘・捏造・飛躍がない

※ 数値目標（◯％以上など）は置かない

---

## フェーズ切り替え規約

* フェーズAは分析専用であり、フェーズBへ自動遷移しない
* フェーズB（買い目生成）は、ユーザーから予算・券種が明示された場合にのみ成立する
* 上記入力がない限り、システムは常にフェーズAに留まる

---

## 要件外（本フェーズでは扱わない）

* 買い目生成ロジック
* データ取得方法
* DB物理設計
* フローチャート
* アルゴリズム詳細・重み・閾値

---

## 備考

* 本要件は将来拡張（フェーズB以降）を否定しない
* フェーズAの正確性・透明性を最優先とする
